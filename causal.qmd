# Causal {#sec-causal}

It shouldn't be controversial to claim that game theory textbooks are committed a broadly causal version of decision theory.[^causal-1] For one thing, they always recommend defecting in Prisoners' Dilemma, even when playing with a twin. As David Lewis showed, this is equivalent to recommending two-boxing in Newcomb's Problem [@Lewis1979e]. They endorse the causal decision theorist's signature argument form: the deletion of strongly dominated strategies. Indeed, the typical book introduces this before it introduces anything about probability. When they do get around to probabilities, they tend to define the expected value of a choice in a way only a causal decision theorist could endorse. In particular, they define expected values using unconditional, rather than conditional, probabilities.[^causal-2] And the probabilities are simply probabilities of states, not probabilities of any kind of counterfactual. Indeed, you can go entire textbooks without even getting a symbol for a counterfactual conditional.

[^causal-1]: This point is made by @Harper1988, and many (though not all) of the conclusions I draw in this paper will be similar to ones he drew.

[^causal-2]: See, for instance, the introduction of them on page 136 of @Bonanno2018. And note that we get 135 pages before the notion of an expectation is introduced; that's how much is done simply with dominance reasoning

What's more controversial is that they are right to adopt a kind of causal decision theory (CDT).[^causal-3] In the recent literature, I think there are three main kinds of problem that have been raised for CDT. First, it does badly in cases where there are no pure ratifiable strategies. Second, it gives strange results in cases involving betting on grand propositions about the past history of the world, or about the laws of nature. Third, it leaves its proponents will less money in Newcomb's Problem than EDT does. In this chapter I'll respond to each of these in turn.

[^causal-3]: Recall that I'm using 'CDT' here as the name for a family of theories. The point of this chapter will be to argue that the member of the family I prefer is immune to several challenges that have been raised against other members of the family.

## No Ratifiable Choices

In some simple cases, neither of the options on the table look very good by the lights of GDT. @tbl-no-ratify-1 is an almost maximally simple case.

|       | PA  | PB  |
|:-----:|:---:|:---:|
| **A** |  0  | 100 |
| **B** | 100 |  0  |

: A problem with no ratifiable choice {#tbl-no-ratify-1}

Everyone agrees that there is nothing to choose between the options here.[^causal-4] Things get complicated when A gets somewhat sweetened, say by adding 99 to the payouts if Chooser selects A, resulting in @tbl-no-ratify-2.

[^causal-4]: Almost everyone agrees that Chooser should be indifferent between A and B here. I don't, for reasons that will become important presently, and will be discussed much more in @sec-indecisive. I think A and B should be treated symmetrically, of course, but they are incomparable not equally good.

|       | PA  | PB  |
|:-----:|:---:|:---:|
| **A** | 99  | 199 |
| **B** | 100 |  0  |

: An asymmetric problem with no ratifiable choice {#tbl-no-ratify-2}

Many versions of CDT, including GDT, do not unconditionally recommend A in this case. Yet there are many problems with the same structure as @tbl-no-ratify-2 where people have insisted that intuition says A is the only rational choice, and it is a problem for a decision theory that doesn't agree.[^causal-5]

[^causal-5]: This objection goes back to @Richter1984. The most memorable version of an asymmetric problem with no ratifiable choice is the Psychopath Button case presented by Andy @Egan2007.

A related objection is raised by Arif @Ahmed2014a and by Jack Spencer and Ian Wells [-@SpencerWells2019]. I'll focus on the latter version, but the points are essentially the same. Start with @tbl-no-ratify-1 and add a third option X. X gets a guaranteed return of 40, and if Demon predicts X, then A and B return 50. They call this problem [The Frustrator](#tbl-frustrator).

|       | PA  | PB  | PX  |
|:-----:|:---:|:---:|:---:|
| **A** |  0  | 100 | 50  |
| **B** | 100 |  0  | 50  |
| **X** | 40  | 40  | 40  |

: The Frustrator {#tbl-frustrator}

They say, and many seem to agree, that intuition says that taking X is the only rational option. This is a bit surprising since there are two things wrong with X. Or, better, there is one thing wrong with X that has two manifestations which turn out to be equivalent.

For one thing X is strongly dominated by the mixed strategy of playing A and B with probability 0.5 each. Whatever Demon does, that mixed strategy has an expected return of 50, while X has a guaranteed return of 40.

For another thing, there is no probability distribution over the three states, PA, PB, and PX, such that X maximises expected utility. If Pr(PA) ≥ Pr(PB), then A will have a higher expected return than X, and if Pr(PB) ≥ Pr(PA), then B will have a greater return than X. In game-theoretic terms, X is not a best response [@Bonanno2018, 41]; no matter what Chooser thinks Demon will do, indeed no matter what probability Chooser has over Demon's choices, X is sub-optimal.

The last two things turn out to be equivalent. As @Pearce1984 shows, an option is sometimes a best response iff it is not strictly dominated by any other pure or mixed strategy.[^causal-6] That is, for any option O, there is some probability distribution over the states such that no alternative to O has a higher expected utility iff there is no mixture of alternatives to O that has a higher expected return than O in all states.

[^causal-6]: @Bonanno2018, 207 attributes this to Pearce, who has a rather elegant proof of the result that involves turning the decision problem into a zero-sum game, and applying a famous result of Nash's.

GDT's response to these kinds of problems is in two parts. One part is to argue, as I will in @sec-indecisive, that the intuitions behind cases like this are unstable. The other is to argue that in fact the right choice here is to play the mixed strategy. That requires arguing that mixed strategies are available, as I will in @sec-mixed, and indeed saying more about what it is to play a mixed strategy. And then it requires appealing to Pearce's result to say that any option ruled out in cases like [The Frustrator](#tbl-frustrator) is in fact strictly dominated, and so not choice-worthy.

There are a lot of promissory notes in the last paragraph, but hopefully I've said enough to say how GDT will, eventually, respond to cases like these.

## Laws, and other Non-Events

-   Cite Ahmed book for the general problem
-   Cite Hedden's recent version
-   Note I'm really dismissing this problem not replying to it
-   Objection 1: This violates the idealising constraints; we don't know what we can do.
-   Objection 2: These are not events, and causal independence requires independent events. (Caveat: All that matters is that it can be treated as an event, as in Spence or ChoKreps. Can it? Eh, maybe.)
-   Objection 3: I think we do maybe cause the laws (or the past). One reason - Humeanism implies future events are partially constitutive of the laws. (Caveat: My response to Hawthorne.) And if determinism is true, then counterfactuals go all funny; maybe the past is counterfactually sensitive to current actions (for yes, see Lewis; for no, see Dorr).
-   General objection: The point is to explain, predict, and maybe evaluate, ordinary people making ordinary decisions. And ordinary people come with ordinary pictures of how the world works. If it turned out the theory didn't even apply to people with non-standard notions of causation, or who applied the notion of causation beyond its intended scope of understanding current day interactions between medium sized dry goods, I wouldn't be too worried.

## War on WAR

That leaves the point that CDT leaves one poorly off in Newcomb's Problem, while other theories, like evidential decision theory (EDT) leave one well off. This isn't a particular mark against CDT, since other theories, like EDT, leave one poorly off in some situations. Here is one such case.

There are two demons, who will predict what Chooser will do. Both of them are arbitrarily good, though not quite perfect, and their errors are independent. Both demons will predict what Chooser does before anything else happens. Chooser will play either the left or right game in @tbl-edt-war.

::: {#tbl-edt-war layout-ncol="2"}
|          | PUp | PDown |
|:--------:|:---:|:-----:|
|  **Up**  |  1  |   3   |
| **Down** |  0  |   2   |

: Demon-1 predicts Down {#tbl-war-left}

|          | PUp  | PDown |
|:--------:|:----:|:-----:|
|  **Up**  | 1001 | 1003  |
| **Down** | 1000 | 1002  |

: Demon-1 predicts Up {#tbl-war-right}

A Newcomb problem with two demons
:::

If Demon-1 predicts that Chooser will play Down, Demon-1 will offer Chooser @tbl-war-left; if Demon-1 predicts that Chooser will play Up, Demon-1 will offer Chooser @tbl-war-right. And Chooser knows what they are playing, that's part of what it is to play a game, so Demon-1's prediction will be announced, though Demon-2's prediction will be secret. After Chooser makes a decision, Demon-2's prediction will be used for determining whether the payout is from column PU or PD. In almost all cases, if Chooser uses CDT, they will get 1001, while if they use EDT, they will get 2. So in this case, CDT will get more than EDT.

This case is not meant as an objection to EDT. It is perfectly fair for the evidential decision theorist to complain that they have simply been the victim of a Demon who intends to punish users of EDT, and reward users of CDT. That seems a perfectly fair complaint. But if the evidential decision theorist makes it, they cannot object when causal decision theorists, such as @Lewis1981e, use the same language to describe Newcomb's Problem. The 'objection' that CDT leaves one poorly off in one particular case is equally an objection to everyone, and so it is an objection to no one.

One might object that this is unfair because at the time they make decisions, the EDTer and the CDTer have different evidence. After all, they will know what Demon-1 predicted and it will (almost certainly) be different in each case. Can we get rid of that step? We can, but it's a bit complicated and has some other complications. The example I'll use to illustrate this is a version of a signalling game of the kind introduced by @Lewis1969a. And in particular it's a version of the broadly adversarial kinds of signalling games that are central to the plot of @ChoKreps1987. It will involve a human Chooser, and a Demon who is excellent at predictions, and the game will have three stages.

At the first stage a fair coin is flipped, and the result shown to Chooser, but not to Demon. At the second stage, Chooser will choose Up or Down, and the choice will be publicly announced. At the third stage, Demon will try to guess what the coin showed. Demon knows the payoff table I'm about to show you, and is arbitrarily good at predicting Chooser's strategy for what to do given how the coin appears. This prediction is causally independent of Chooser's choice, but Demon's guess is not independent; it could be affected by the choice. The payoffs to each player are a function of what happens at each of the three steps, and are given by table @tbl-payoffs-demon-coin. (The payoffs here are all in utils.)

| Coin | Chooser | Demon | Chooser Payoff | Demon Payoff |
|:----:|:-------:|:-----:|:--------------:|:------------:|
|  H   |    U    |   H   |       40       |      1       |
|  H   |    U    |   T   |      400       |      0       |
|  H   |    D    |   H   |       0        |      1       |
|  H   |    D    |   T   |       0        |      0       |
|  T   |    U    |   H   |       40       |      0       |
|  T   |    U    |   T   |       28       |      1       |
|  T   |    D    |   H   |       0        |      0       |
|  T   |    D    |   T   |       44       |      1       |

: Payouts for the coins and signals game {#tbl-payoffs-demon-coin}

```{r}
#| echo: FALSE
#| output: FALSE
require(Rcpp)
require(tidyverse)
```

@fig-second-anti-war shows the game they are playing in tree form. We start at the middle, then move left or right depending on the coin flip, up or down depending on Chooser's choice, and at one or other angle depending on Demon's choice. Demons's payoffs are just as you'd expect - they get rewarded iff they figure out how the coin landed. Chooser's payoffs are more complicated, but the big things to note are the huge payout if they get to the top-left and Demon does not make a correct prediction, and the generally poor payouts for choosing Down.

```{r engine='tikz'}
#| label: fig-second-anti-war
#| fig.cap: "Tree Diagram of the Coins and Signals Game"
#| fig.ext: 'png'
#| cache: TRUE
#| echo: FALSE
#| fig.width: 4

\usetikzlibrary{calc}

\begin{tikzpicture}[scale=1.4,font=\footnotesize]
\tikzset{
% Two node styles for game trees: solid and hollow
solid node/.style={circle,draw,inner sep=1.5,fill=black},
hollow node/.style={circle,draw,inner sep=1.5},
square node/.style={rectangle,draw, inner sep = 1, fill = black}
}

% Specify spacing for each level of the tree
\tikzstyle{level 1}=[level distance=12mm,sibling distance=25mm]
\tikzstyle{level 2}=[level distance=15mm,sibling distance=15mm]
\tikzstyle{level 3}=[level distance=13mm,sibling distance=11mm]

% The Tree
\node(0)[hollow node,label=above:{Nature}]{}
child[grow=left]{node[solid node,label=left:{
$Chooser$
}] {}
child[grow=up]{node(1)[solid node]{}
child{node[square node,label=above:{$400,0$}]{} edge from parent node [right]{$T$}}
child{node[square node,label=above:{$40,1$}]{} edge from parent node [left]{$H$}}
edge from parent node [left, yshift = -5]{$Up$}
}
child[grow=down]{node(3)[solid node]{}
child{node[square node,label=below:{$0,1$}]{} edge from parent node [left]{$H$}}
child{node[square node,label=below:{$0,0$}]{} edge from parent node [right]{$T$}}
edge from parent node [left, yshift = 5]{$Down$}
}
edge from parent node [below, align=center]{$H$ \\ $0.5$}
}
child[grow=right]{node[solid node,label=right:{
$Chooser$
}] {}
child[grow=up]{node(2)[solid node]{}
child{node[square node,label=above:{$28,1$}]{} edge from parent node [right]{$T$}}
child{node[square node,label=above:{$40,0$}]{} edge from parent node [left]{$H$}}
edge from parent node [right, yshift = -5]{$Up$}
}
child[grow=down]{node(4)[solid node]{}
child{node[square node,label=below:{$0,0$}]{} edge from parent node [left]{$H$}}
child{node[square node,label=below:{$44,1$}]{} edge from parent node [right]{$T$}}
edge from parent node [right, yshift = 5]{$Down$}
}
edge from parent node [below,align=center]{$T$ \\ $0.5$}
};

% information set
\draw[dashed,rounded corners=10]($(1) + (-.45,.45)$)rectangle($(2) +(.45,-.45)$);
\draw[dashed,rounded corners=10]($(3) + (-.45,.45)$)rectangle($(4) +(.45,-.45)$);
% specify mover at 2nd information set
\node at ($(1)!.5!(2)$) {$Demon$};
\node at ($(3)!.5!(4)$) {$Demon$};
\end{tikzpicture}
```

I intend the Demon to be a rational player in a game-theoretic sense. But to translate that into decision-theory terms, it's important to make a few stipulations.[^causal-7] Demon predicts Chooser's strategy, that is Chooser's plan about what to do if the coin lands Heads and what to do if the coin lands Tails, before the game starts. They make their guess about how the coin landed after seeing Chooser's actual choice, and updating their prior beliefs (about both the coin and Chooser) with this information. If they predict that Chooser will do the same thing however the coin lands, they will have no useful information about the coin, so they will flip their own coin to make a guess. In that case it will be 50/50 whether Demon says Heads or Tails. Also, Demon is surprised by what Chooser does, i.e., if they had predicted Chooser would do one thing however the coin lands but Chooser does the other thing, Demon will also flip their own coin to make a guess.[\^A key part of the discussion in @ChoKreps1987 is that in sone cases we can say substantuve things about what a player will do if they are surprised in this sense. But @fig-second-anti-war is not one of these cases.] Finally, Demon's predictions are arbitrarily accurate. For simplicity, I'll assume Demon is correct with probability 1, though it doesn't matter if you allow for probability $\varepsilon$ that Demon gets it wrong.

[^causal-7]: I'll make the same stipulations in subsequent cases that involve Demon and games that unfold over time.

Now I want to analyse what Chooser will do if they follow EDT. It should be fairly clear that if the coin lands Heads, Chooser should say Up. The worst possible return from Up is 40, the best possible return from Down is 0. So that's what any theory would recommend, and Chooser will do that whether or not they follow EDT. Indeed, this is so clear that we should assume Demon will predict that Chooser will play Up if the coin lands Heads. So what happens if the coin lands Tails? There are four possibilities here: the two things Chooser might do crossed with the two predictions Demon might make. The expected return to Chooser in these four possibilities is given in @tbl-payout-if-tails.

|          | Predict Up | Predict Down |
|:--------:|:----------:|:------------:|
|  **Up**  |     34     |      40      |
| **Down** |     18     |      44      |

: The expected payout to Chooser in four cases if the coin lands Tails {#tbl-payout-if-tails}

The numbers in @tbl-payout-if-tails aren't entirely obvious; I'll spell out how I got them.

-   If Demon predicts Up, Demon will flip a coin. That's because they'll either get no information (if Chooser plays Up), or will be surprised (if Chooser plays Down). So Chooser will get the average of lines 5 and 6 in @tbl-payoffs-demon-coin if they play Up, and the average of lines 7 and 8 if they play Down.
-   If Demon predicts Down, and Chooser plays Up, Demon will think (falsely) that the coin must have landed Heads, since Demon will have predicted that Chooser will only say Up if Heads. So Demon will say Heads. So we'll definitely be at line 5 of @tbl-payoffs-demon-coin, where Chooser gets 40.
-   If Demon predicts Down, and Chooser plays Down, Demon will think (correctly) that the coin must have landed Tails. So Demon will say that, and we'll be at line 8 of @tbl-payoffs-demon-coin.

In a decision problem like @tbl-payout-if-tails, EDT says that all that matters is which of the top-left and bottom-right cells is largest. In this case, it's the bottom-right, so EDT says to play Down. That isn't absurd in this case; it gets the best possible payout of 44. So that's our analysis of the game for EDT: Chooser plays Up if Heads, Down if Tails, gets 40 if Heads and 44 if Tails (plus/minus a small amount in expectation if Demon has $\varepsilon$ chance of being wrong), and on average gets 42.

GDT does not give any clear verdict about what to do in @tbl-payout-if-tails; it says either Up or Down is permissible. So following GDT doesn't mean you'll do better than EDT in this game; you might do exactly as well as EDT. But all it takes to get a "Why Ain'cha Rich?" argument going is to show that one theory does better than EDT. And the version of CDT that Dmitri @Gallow2020 endorses implies that one should play Up in @tbl-payout-if-tails. So someone following his theory will play Up however the coin lands. So Demon will always flip a coin to decide what to do. So all of the top four outcomes in @fig-second-anti-war are equally likely, and Chooser will on average get a return of 127. Since 127 \> 42, that means that on average if Chooser follows Gallow's theory, they will on average be much richer than if they follow EDT. So if "Why Ain'Cha Rich?", they show that EDT should be rejected in favor of Gallow's theory.

Ian @Wells2019 has earlier offered an example where EDT predictably does worse than (all versions of) CDT. His case involves a two-step game, where the EDTer will, at step 2, make a decision that everyone, whether they believe in CDT or EDT or any other plausible theory, think is bad from the perspective of the player at step 1. At round 1 the players can pay to tie their hands at round 2, and the EDTer will make this payment. (As would the CDTer who thinks they will become an EDTer before round 2 starts.) Arif @Ahmed2020 responds that this is an unfair criticism. In Wells's cases, he says, the EDT and CDT deciders are not in equivalent situations in round one. The EDTer knows that they will use EDT in later rounds, and the CDTer knows that they will use CDT in later rounds. So they have different evidence about what will happen at some later time in a way that's relevant to their current decision, so it's not a like-for-like comparison between CDT and EDT at the first stage.

I don't think this is a fair criticism of Wells, or a successful defence of EDT. But even if you think EDT survives Wells's criticisms, that response doesn't work here. Chooser will definitely choose Up if the coin lands Heads, whether they follow EDT, Gallow's theory, or any remotely plausible theory. And this is common knowledge. Demon knows this, and Chooser knows that Demon knows it, and so on. The only difference is that if Chooser follows EDT, they will play Down if Tails. And that's good as far as it goes; they'll probably get the highest possible payoff they can get at that point. More importantly for this debate, they will have the same subjective states if Tails is true whether they follow EDT, Gallow's theory, or anything else. They will believe that they would have played Up if Heads, and that the Demon would have predicted that. So the different choices they make if the coin lands Tails can't be traced back to differences in their subjective states. So the complaint that Ahmed makes about Wells's examples can't be made here (even setting aside the question of whether it is fair complaint). Nonetheless, the EDTer ends up with less money in the long run than the follower of Gallow's theory when playing this game.

All of this is to say that while followers of EDT end up with more money than followers of causal theories *when playing Newcomb's Problem*, this is not because of the distinctive money-making powers of EDT. It's because Newcomb's Problem is designed to leave causally based decision theories badly off. Design a case to leave evidential theories badly off, and they'll be badly off. The "Why Ain'Cha Rich?" consideration tells against everyone, so it overgenerates, so it should be rejected.

Well, not quite everyone. It doesn't tell against some kind of 'resolute' decision theories which recommend one-box in Newcomb's Problem, Up in @tbl-edt-war, and always Up in @fig-second-anti-war. Those theories leave their proponents well off in all three cases. The so-called 'foundational decision theory' that @LevinsteinSoares2020 endorse also endorse the same three choices. But those theories are vulnerable to much more serious objections, that I'll come to in @sec-dualmandate.

So I conclude that there is no good objection to adopting a broadly causal decision theory, much as the game theorists do. But which version of CDT do they adopt, and are they right to do so? That will take us much more time.
